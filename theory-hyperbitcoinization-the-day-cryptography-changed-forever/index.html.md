 

<blockquote class="kg-blockquote-alt">Этот пост – пролог к серии материалов, посвященных становлению движения шифропанков, призванных познакомить сообщество с технологиями, предшествующими киберкоммерции, рассвет которой мы сегодня наблюдаем. Понимание истории, осознание мотивов и методов достижения целей первопроходцами в области криптографии и информатики поможет не только пролить свет на возможные варианты дальнейшего развития событий, но и выстроить более эффективные стратегии по защите собственных средств, приватной информации и личностного суверенитета.<br/>Следующие серии расскажут об основных открытиях в области криптографии, которые послужили строительными блоками в фундаменте Биткоина.</blockquote>

<figure class="kg-card kg-embed-card kg-card-hascaption"><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="" frameborder="0" height="113" src="https://www.youtube.com/embed/4KNuG-hxZPg?feature=oembed" width="200"></iframe><figcaption>Эта серия документальных видео о становлении движения шифропанков послужит отличным дополнением к данной текстовой серии. Ссылка на плейлист: <a href="https://youtube.com/playlist?list=PLfCndTr__6HfnWzqQxso2Jh8AtlhCy3wf">https://youtube.com/playlist?list=PLfCndTr__6HfnWzqQxso2Jh8AtlhCy3wf</a></figcaption></figure>

---

1 августа 1977 года научно-популярный журнал [_Scientific American_](https://www.scientificamerican.com/) выпустил свое ежемесячное издание, публикуемое с 1921 года. Это – интересная смесь математики, естественных наук, техники, биологии, механики, географии и других дисциплин. В конце публикации на странице 120 была опубликована короткая статья популярного математика [Мартина Гарднера](http://martin-gardner.org/) под названием "Математические игры".

В ней он описал _"новый вид шифра, для взлома которого потребуются миллионы лет"_.

Новая форма криптографии, названная RSA в честь ее изобретателей Рона __Р__ивеста, Ади __Ш__амира и Леонарда __А__длемана, по утверждению автора, должна была стать предвестником новой эры в криптографии. Как оказалось, его прогноз не был ошибочным.

<figure class="kg-card kg-image-card kg-card-hascaption"><img alt="" class="kg-image" loading="lazy" src="https://lh6.googleusercontent.com/CSks-EYZzGw8BdTsx3YqBOtaoz7EjkupMZhXfOnH_wbtPuUUuGZ2J4NvxUzzZvT8nxEzmXnQHis9vaUsY2csKbAffnJFCCxAICrLachhfUvILVapkxLsnUMu7neY4iJcj2TaGXbc"/><figcaption><em>Августовский выпуск журнала Scientific American за 1977 год.</em></figcaption></figure>

<h1 id="%D1%87%D1%82%D0%BE-%D0%BD%D1%83%D0%B6%D0%BD%D0%BE-%D0%BC%D0%B8%D1%80%D1%83-%D1%82%D0%B0%D0%BA-%D1%8D%D1%82%D0%BE-%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5-%D0%BD%D0%B5-%D1%82%D1%80%D0%B5%D0%B1%D1%83%D1%8E%D1%89%D0%B5%D0%B5-%D0%B4%D0%BE%D0%B2%D0%B5%D1%80%D0%B8%D1%8F">Что нужно миру, так это... шифрование, не требующее доверия</h1>

До 1977 года в криптографии доминировали [потоковые шифры](https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%B2%D1%8B%D0%B9_%D1%88%D0%B8%D1%84%D1%80) и, в частности, [шифр Вернама](https://ru.wikipedia.org/wiki/%D0%A8%D0%B8%D1%84%D1%80_%D0%92%D0%B5%D1%80%D0%BD%D0%B0%D0%BC%D0%B0). Шифр Вернама – это случайная последовательность букв или битов, которая при соединении с исходным сообщением создает псевдослучайную последовательность. Не зная одноразового ключа, невозможно расшифровать зашифрованное сообщение. Но если вы знаете ключ, то извлечь исходное сообщение из шифра – тривиальная задача.

Математическая теория показывает, что потоковые шифры в общем и шифр Вернама в частности являются самой безопасной и надежной формой криптографии. Однако использование такой формы шифрования сопряжено с довольно обременительными и громоздкими требованиями к реализации.

<figure class="kg-card kg-image-card kg-card-hascaption"><img alt="" class="kg-image" loading="lazy" src="https://lh5.googleusercontent.com/Oxm8hJveFegJXe2PZ-76AzEhz1ktH1RboBfPYNzbG4dojE7WyEtI1MloxohxjEc2C0sQ0KPmpd6KUNhcWiu1hE6IoPTo5vXWdOUXKM1sb4mW3E8hFldzWLQ8BZm-QdiE3rK1zS6I"/><figcaption><em>Известная ныне статья Мартина Гарднера о шифровании с открытым ключом RSA, опубликованная в августовском номере журнала Scientific American за 1977 год.</em></figcaption></figure>

Во-первых, ключ может быть использован только один раз (поскольку использование одного и того же ключа для двух разных сообщений моментально делает шифр бесполезным), а во-вторых, ключ всегда должен быть такой же длины, как и исходное сообщение.

Это означает, что две стороны, желающие безопасно общаться с помощью симметричного шифрования, должны найти способ поделиться друг с другом ключом до начала общения.

Если такие стороны заранее не знакомы или разделены большим расстоянием или временем, это создает логистическую проблему: они должны каким-то образом поделиться ключами друг с другом, прежде чем может быть налажено зашифрованное общение. Более того, если эти стороны каким-то образом найдут способ безопасно передать друг другу эти ключи (через частного курьера, заказным письмом, на атомной подводной лодке и т.д.), возникает вопрос: почему бы просто не использовать этот канал для связи и не беспокоиться о шифровании вообще.

<h1 id="%D0%BD%D0%B0%D0%B7%D1%80%D0%B5%D0%B2%D0%B0%D0%B5%D1%82-%D1%86%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D1%8F-%D0%B1%D1%83%D1%80%D1%8F">Назревает цифровая буря...</h1>

На этом фоне, если бы вы взглянули на цифровой ландшафт в 1977 году, вы бы увидели гигантскую приливную волну, начинающую формироваться далеко на горизонте. Эта приливная волна была слиянием компьютерного и сетевого оборудования, программного обеспечения и протоколов, которые со временем сформировали цифровую революцию, которую мы переживаем сегодня.

Многие из ключевых компонентов современных вычислительных и сетевых технологий уже были открыты или изобретены и ждали подходящих условий для массового внедрения.

ARPANET (распределенная сеть с коммутацией пакетов и предшественница современного интернета) уже существовала и использовалась в различных корпоративных и академических центрах. TCP (протокол управления передачей, протокол, [ориентированный на соединение](https://en.wikipedia.org/wiki/Connection-oriented_communication), используемый интернетом) и FTP ([протокол передачи файлов](https://ru.wikipedia.org/wiki/FTP), используемый для передачи компьютерных файлов между клиентом и сервером в сети) также уже использовались. Были изобретены различные формы обмена электронными сообщениями “тет-а-тет”, такие как [FTPmail](https://en.wikipedia.org/wiki/FTPmail) и Mail Protocol (который в 80-х годах превратился в электронную почту с использованием SMTP), которые использовались для отправки почтовых сообщений через ARPANET. В 1965 году [Гордон Мур](https://ru.wikipedia.org/wiki/%D0%9C%D1%83%D1%80,_%D0%93%D0%BE%D1%80%D0%B4%D0%BE%D0%BD), тогдашний генеральный директор Intel, предсказал ежегодное удвоение количества компонентов на интегральную схему (в 1975 году он изменил прогноз на удвоение каждые два года). Его предсказание стало известно как [закон Мура](https://ru.wikipedia.org/wiki/%D0%97%D0%B0%D0%BA%D0%BE%D0%BD_%D0%9C%D1%83%D1%80%D0%B0) и обещало постоянный и устойчивый прогресс в цифровой электронике и аппаратном обеспечении.

Такие компьютерные компании, как Intel, IBM, SAP и Honeywell, уже были хорошо известны. Двумя годами ранее два молодых предпринимателя основали компанию в Альбукерке, штат Нью-Мексико, для разработки и продажи [интерпретаторов](https://ru.wikipedia.org/wiki/%D0%98%D0%BD%D1%82%D0%B5%D1%80%D0%BF%D1%80%D0%B5%D1%82%D0%B0%D1%82%D0%BE%D1%80) языка BASIC для [Altair 8800](https://ru.wikipedia.org/wiki/Altair_8800). А за год до этого другой молодой предприниматель стал соучредителем компании в доме своего детства на Крист Драйв в Лос Альтос, Калифорния. Этими компаниями были Microsoft и Apple соответственно.

Программное и аппаратное обеспечение было готово к широкомасштабному и всепроникающему внедрению.

Но со стороны сетевых технологий им не хватало одного важнейшего компонента: бездоверительного шифрования, позволяющего осуществлять связь между двумя незнакомыми сторонами. Для процветания настоящей многоузловой и децентрализованной сети, подобной интернету, был необходим способ безопасного общения между ранее незнакомыми участниками сети. Имеющийся метод использования потоковых шифров предъявлял слишком жесткие требования к членам сети, которые должны были заранее договориться и поделиться ключом шифрования.

<h1 id="%D0%B7%D0%B0%D0%B3%D0%B0%D0%B4%D0%BA%D0%B8-%D0%BC%D0%B5%D1%80%D0%BA%D0%BB%D0%B0-%E2%80%93-%D0%BF%D0%B5%D1%80%D0%B2%D0%B0%D1%8F-%D0%BF%D0%BE%D0%BF%D1%8B%D1%82%D0%BA%D0%B0-%D1%80%D0%B5%D1%88%D0%B8%D1%82%D1%8C-%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%83">Загадки Меркла – первая попытка решить проблему</h1>

Первая признанная попытка решить проблему распределения ключей была предпринята в 1974 году, когда программист [Ральф Меркл](https://ru.wikipedia.org/wiki/%D0%9C%D0%B5%D1%80%D0%BA%D0%BB,_%D0%A0%D0%B0%D0%BB%D1%8C%D1%84) предложил решение, позволяющее двум сторонам договориться о секретном ключе путем обмена сообщениями, даже если у них нет общих секретов.

Протокол работает следующим образом:

1.   Предположим, что Алиса и Боб хотят безопасно общаться.
2.   Алиса создает большое количество головоломок (математическая задача, которую трудно, но не невозможно решить).
3.   Боб случайным образом выбирает одну из присланных ему головоломок и решает ее.
4.   Расшифрованное решение содержит идентификатор и ключ сеанса (который будет служить ключом для их общения). Боб передает идентификатор обратно Алисе, тем самым указывая ей, какую головоломку он решил.
5.   Теперь у обеих сторон есть общий ключ: у Боба – потому что он решил головоломку, а у Алисы – потому что она отправила головоломку.
6.   Любая подслушивающая сторона (скажем, Ева) имеет более сложную задачу, поскольку она не знает, какую из головоломок решил Боб. Ее лучшая стратегия – решить все головоломки, но поскольку их очень много, это требует бóльших вычислительных затрат для Евы, чем для Боба.

Математический анализ протокола показывает, что для злоумышленника (Евы) существует временнáя сложность между временем и затратами на решение всех головоломок по сравнению с Алисой и Бобом.

В наши дни временнáя сложность, как правило, не считается достаточно безопасной защитой от злоумышленника в контексте практических реальных криптографических приложений. Кроме того, протокол Merkle Puzzle требует, чтобы Алиса придумала большое количество головоломок и отправила их Бобу. Это, очевидно, представляет собой довольно большой объем работы для Алисы, а также довольно большой объем сетевого трафика между Алисой и Бобом. Учитывая эти требования, данный протокол считается слишком неэффективным для практического использования. Однако не следует забывать о значимости вклада Меркла. Это была первая реализация схемы, в которой два участника могут придумать ключ "на лету", и в которой существует значительный разрыв между количеством работы, необходимой участникам, чтобы придумать ключ, и количеством работы, необходимой злоумышленнику, чтобы взломать его. Эта работа также послужила источником вдохновения для нового протокола распределения ключей, разработанного два года спустя...

<h1 id="%D0%B2%D0%B0%D0%B6%D0%BD%D1%8B%D0%B9-%D1%82%D0%B5%D0%BE%D1%80%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9-%D0%BF%D1%80%D0%BE%D1%80%D1%8B%D0%B2">Важный теоретический прорыв</h1>

Вдохновленные работой Меркла, 6 ноября 1976 года два профессора Гарварда, [Уитфилд Диффи](https://ru.wikipedia.org/wiki/%D0%94%D0%B8%D1%84%D1%84%D0%B8,_%D0%A3%D0%B8%D1%82%D1%84%D0%B8%D0%BB%D0%B4) и [Мартин Хеллман](https://ru.wikipedia.org/wiki/%D0%A5%D0%B5%D0%BB%D0%BB%D0%BC%D0%B0%D0%BD,_%D0%9C%D0%B0%D1%80%D1%82%D0%B8%D0%BD), опубликовали теоретическую работу, в которой были решены многие давние проблемы, связанные с не требующим доверия шифрованием и распределением ключей.

<figure class="kg-card kg-image-card kg-card-hascaption"><img alt="" class="kg-image" loading="lazy" src="https://lh3.googleusercontent.com/05_--kUM7osZl-Z3eGAFchCVfnleCFQBprxv39RBWhNfU1SirGz5AZMQNSzDvkDLr9s2uLCg7sM0aN1XnPMHnCNRNN2iQMXBhJd2eKa4HsSKDKsRlqahHSqZd0-SAIgeKR8eGzvh"/><figcaption><em>“</em><a href="https://ee.stanford.edu/~hellman/publications/24.pdf"><em>Новые направления в криптографии</em></a><em>" – статья Уитфилда Диффи и Мартина Хеллмана, опубликованная в 1976 году.</em></figcaption></figure>

Диффи и Хеллман полностью осознали, как недостатки криптографии, существовавшие в то время, препятствовали безопасному и удобному общению между двумя незнакомцами. Они также поняли, что единственный способ решить проблему обмена ключами – это использование сложной математики. Другими словами, как они выразились, "превратить это древнее искусство в науку".

Их блестящим и новаторским решением проблемы стала [криптография с открытым ключом](https://ru.wikipedia.org/wiki/%D0%9A%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0_%D1%81_%D0%BE%D1%82%D0%BA%D1%80%D1%8B%D1%82%D1%8B%D0%BC_%D0%BA%D0%BB%D1%8E%D1%87%D0%BE%D0%BC). В этом протоколе существует два набора ключей для шифрования и расшифровки (мы будем называть их __E__ и __D__).

Протокол использует математические свойства, чтобы гарантировать, что:

*   __E__ является _обратным_ __D__
*   вычислить __E__ и __D__ легко
*   нахождение __D__ из __E__ является вычислительно невыполнимым (т.е. \*очень_\*_ трудным)
*   __E__ может быть публично раскрыто без нарушения целостности __D__ (исходя из условия выше).

Свойства такого протокола позволяют вести приватный разговор между людьми, которые никогда раньше не общались.

Каким образом?

1.   Пользователь (Боб) генерирует пару обратных преобразований __E__ и __D__.
2.   Расшифровывающее преобразование __D__ должно храниться в секрете и не должно никому сообщаться.
3.   Ключ шифрования __E__ можно сделать публичным, поместив его в публичный каталог вместе с именем и адресом Боба.
4.   Любой человек (скажем, Алиса) может найти в каталоге публичный ключ Боба __E__, зашифровать сообщения с помощью __E__ и отправить их Бобу, но __никто другой не сможет расшифровать сообщения, предназначенные Бобу, кроме самого Боба (который использует для этого D)__.

Концепция односторонней функции предлагала эффективное решение для обмена ключами. Однако оба автора признали, что практическая реализация протокола все еще остается "открытой проблемой", и предложили читателям приложить свои усилия для ее решения. Прорыв произошел менее чем через год.

<h1 id="%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D0%BD%D0%B0-%D0%BF%D1%80%D0%B0%D0%BA%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F-%D0%BE%D0%B4%D0%BD%D0%BE%D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%BD%D0%BD%D1%8F%D1%8F-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F">Разработана практическая односторонняя функция</h1>

<figure class="kg-card kg-image-card kg-card-hascaption"><img alt="" class="kg-image" loading="lazy" src="https://lh6.googleusercontent.com/ex9yn5F90poAW4CruJPX10kYe-ukzKv0cdY8fAi_Ty5R8lbXmiRu7T7YOvVWFyOjBhqq0bcZnP8fGqjXe4wHjoaKcvSiF-VtKT0FYyJXy1pdxjWHrv5sJeegEtfGIP1sWC97VzBl"/><figcaption><em>Работа Роналда Ривеста, Ади Шамира и Лена Адлемана "</em><a href="https://apps.dtic.mil/dtic/tr/fulltext/u2/a039036.pdf"><em>О цифровых подписях и криптосистемах с открытым ключом</em></a><em>", опубликованная в 1977 году.</em></figcaption></figure>

Рональд Ривест и Ади Шамир были программистами из Массачусетского технологического института, а Лен Адлеман – математиком.

Работа Диффи-Хеллмана захватила их воображение, и они попытались найти реализацию, которая удовлетворяла бы его спецификациям. Когда Ривест или Шамир предлагали новую теоретическую схему, Адлеман обычно отвергал ее после нескольких минут анализа. Около полуночи во время седера Пасхи в 1977 году Ривест позвонил Адлеману с идеей использовать факторизацию простых чисел в качестве функции-ловушки. Адлеману не удалось найти в этой идее никаких дыр. _(На самом деле, спустя более 40 лет никому так и не удалось этого сделать)._

Эффективность односторонней функции RSA основана на том, что __перемножить два больших простых числа легко, но разложить это произведение на два простых составляющих его числа – очень сложно__.

Простые числа – числа больше единицы, которые делятся только на единицу и сами на себя – обладают особыми математическими свойствами, которые интриговали математиков на протяжении веков. Блестящая идея Ривеста, Шамира и Адлемана заключалась в том, чтобы использовать эти свойства простых чисел для создания практичной и эффективной функции-ловушки.

Я рекомендую читателю ознакомиться с оригинальной статьей, чтобы получить подробное представление об арифметической реализации протокола. Вкратце, чтобы использовать RSA:

1.   Найдите два простых числа __P__ и __Q__ (обычно каждое из них состоит из сотен цифр) и перемножьте их вместе, чтобы получить их произведение, называемое __N__.
2.   Сгенерируйте число, называемое [функцией Эйлера](https://ru.wikipedia.org/wiki/%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F_%D0%AD%D0%B9%D0%BB%D0%B5%D1%80%D0%B0) и обозначаемое __φ(N)__, которое рассчитывается как __(P-1)__ \* __(Q-1)__. Это число представляет собой количество целых чисел, [взаимно простых](https://ru.wikipedia.org/wiki/%D0%92%D0%B7%D0%B0%D0%B8%D0%BC%D0%BD%D0%BE_%D0%BF%D1%80%D0%BE%D1%81%D1%82%D1%8B%D0%B5_%D1%87%D0%B8%D1%81%D0%BB%D0%B0) с __N__ (за исключением числа 1, которое относительно просто к каждому ненулевому целому числу).
3.   Найдите число __E__ (ключ шифрования), которое взаимно просто с числами __N__ и __φ(N)__.
4.   Определите число __D__ (ключ дешифрования), которое является обратным по модулю числа __E__. Это вычисляется с помощью уравнения __E \* D = 1 (mod φ(N))__.
5.   __Публичный ключ__ – это число __N__ и число __E__.
6.   __Приватный ключ__ – число __N__ и число __D__.

Шифр достигается путем возведения сообщения в степень __E mod N__. Расшифровка достигается путем возведения шифра в степень __D mod N__.

<!--kg-card-begin: markdown-->

C ≡ Mᴱ mod N  
M ≡ Cᴰ mod N

<!--kg-card-end: markdown-->

(операция "mod", используемая выше, описана [здесь](https://brilliant.org/wiki/modular-arithmetic/)).

<h1 id="%D0%B7%D0%B0%D0%BA%D0%BB%D1%8E%D1%87%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D0%B5-%D0%B7%D0%B0%D0%BC%D0%B5%D1%87%D0%B0%D0%BD%D0%B8%D1%8F">Заключительные замечания</h1>

Хотя Ривест, Шамир и Адлеман опубликовали свою работу в апреле 1977 года, именно публикация в журнале Scientific American 4 месяца спустя оповестила мир об их открытии и ознаменовала начало новой эры криптографии.

Влияние криптографической системы с открытым ключом Диффи-Хелмана и ее реализации RSA трудно переоценить. Шифрование с открытым ключом сегодня является основой для большинства регулярно используемых протоколов безопасности в интернете, а также имеет фундаментальное значение для обеспечения конфиденциальности, целостности и аутентификации в современных системах связи.

Кроме того, технологии шифрования с 1976 года являются общественным достоянием и не контролируются ни одной организацией. Как позже сказал Диффи, после публикации их статьи криптографическая монополия Агентства национальной безопасности была фактически прекращена.

<blockquote class="kg-blockquote-alt"><em>"Каждая компания, каждый гражданин теперь обрели доступ к тем видам криптографических технологий, которые еще не так давно были источником силы наряду с атомной бомбой"</em>.</blockquote>

Интересно, что никто не смог доказать, что факторизация простых чисел сложна с вычислительной точки зрения _(другими словами, у нас нет гарантий, что в будущем кто-то не откроет метод эффективного факторизации больших простых чисел)_. Тем не менее, за более чем 40 лет, в то время как были обнаружены определенные слабости в реализации алгоритма, никто не добился реального прогресса в атаке на ядро алгоритма.

Поэтому мы можем с уверенностью предположить, что эти протоколы и стандарты будут работать еще долго.

<figure class="kg-card kg-image-card kg-card-hascaption"><img alt="" class="kg-image" loading="lazy" src="https://lh5.googleusercontent.com/g1PhqUfAJmAOrR6aFPwBecACRnVGyXilfdKa4AIn0sjSa_gpkeGO9KfDQX0oH23r8HEdX6PNXtIsIg3e4nbMbQqvC15uowE0TH4r_j9qeDMADLo8csvE5UjgNBKyszJcbY26Cw2I"/><figcaption><em>Герои современной криптографии. Слева направо: Ади Шамир, Рон Ривест, Лен Адлеман, Ральф Меркл, Мартин Хеллман и Уитфилд Диффи (Фотография любезно предоставлена Эли Бихамом, сделана на презентации 21 августа на </em><a href="http://www-cse.ucsd.edu/users/mihir/crypto2k/program.html"><em>Crypto 2000</em></a><em>, конференции </em><a href="http://www.iacr.org/"><em>IACR</em></a><em>).</em></figcaption></figure>

---

[Оригинал статьи на английском](https://medium.com/swlh/the-day-cryptography-changed-forever-1b6aefe8bda7).